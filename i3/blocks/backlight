#!/usr/bin/env sh

symbol='<span font="FontAwesome5ProSolid">&#xf042;</span>'
current_backlight=$(xbacklight)

if [ "$button" -eq 1 ]; then

  new_backlight=$( yad                      \
    --scale                                 \
    --vertical                              \
    --value="$current_backlight"            \
    --height="255"                          \
    --width="60"                            \
    --min-value="1"                         \
    --max-value="100"                       \
    --text="$symbol Choose a new backlight" \
    --mouse )
  if [ "$?" -eq 0 ]; then
    xbacklight -set $new_backlight
    pkill --signal SIGRTMIN+10 i3blocks
  fi
fi

if [ "$#" -eq 0 ]; then
  echo "$symbol" $(printf '%.3d' $current_backlight)
  exit 0
fi

case "$1" in
  brighter)
    xbacklight -inc 5
    ;;
  darker)
    xbacklight -dec 5
    ;;
  reset)
    xbacklight -set 100
    ;;
esac
pkill --signal SIGRTMIN+10 i3blocks # refresh
