# These instructions establish a thorough base installation of user space
# components. Run this script after the system has been configured as
# instructed on 'https://wiki.artixlinux.org/Main/Installation'.

# Enable arch repos
sudo pacman -Syu artix-archlinux-support
sudo cp /etc/pacman.conf /etc/pacman.conf.backup-"$(date -Iseconds)"
sudo cp pacman.conf /etc/pacman.conf
sudo pacman -Syu

# symlink and source .profile. This will provide the environment necessary
# for the installation of many other applications.
ln -sf "$(realpath .profile)" ~
. ~/.profile
mkdir -p "$XDG_CONFIG_HOME" "$XDG_CACHE_HOME" "$XDG_DATA_HOME" \
	"$XDG_RUNTIME_DIR" "$XDG_STATE_HOME"

# install base system configuration
makepkg -si --needed
git clean -xff .
sudo ln -sf /etc/runit/sv/NetworkManager /run/runit/service/
sudo ln -sf /etc/runit/sv/acpid /run/runit/service/
sudo ln -sf /etc/runit/sv/cronie /run/runit/service/
sudo ln -sf /etc/runit/sv/cupsd /run/runit/service/
sudo ln -sf /etc/runit/sv/sshd /run/runit/service/
sudo ln -sf /etc/runit/sv/udevd /run/runit/service/
sudo ln -sf /etc/runit/sv/bluetoothd /run/runit/service/
sudo ln -sf /etc/runit/sv/boltd /run/runit/service/
sudo ln -sf /etc/runit/sv/docker /run/runit/service/
sudo ln -sf /etc/runit/sv/dbusd /run/runit/service/

# change shell
chsh -s /usr/bin/zsh
